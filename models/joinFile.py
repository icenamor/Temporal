#! /usr/bin/env python
# -*- coding: utf-8 -*-
__author__      = "Isabel Cenamor"
__copyright__   = "Copyright 2014, Temporal Portfolio Project Features"
__email__ = "icenamor@inf.uc3m.es, 	I.Cenamor@hud.ac.uk"

import sys
import string
import os
from head import Head

##translateFile --> translate
##features.arff --> preprocess
def readFile(name, datos):
	print name
	fd = open(name,'r')
	linea = fd.readline()
	while linea != "":
		datos.append(linea)
		linea = fd.readline()
	return datos

def writeFile(name, data, head):
	fd = open(name,'w')
	for i in head.head:
		fd.write(i)
	line = ""
	for i in data:
		line = line + i
	print line
	entry = line + ",no-planner,?\n"
	fd.write(entry)
	
	fd.close()
	
def join(translate, preprocess, union):

	if(len(translate) > 0):
		union = union + translate[0]
		print union
	else:
		print "There is not translate"
		entry_translate = "?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?"
		union = union + entry_translate
	union = union + ","
	if(len(preprocess) > 0):
	
		union = union + preprocess[0][:len(preprocess[0])-1]
	else:
		print "There is not preprocess"
		entry_translate = "?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?"
		union = union + entry_translate
	return union
# -----------------------------------------------------------------------------
# main
# -----------------------------------------------------------------------------
if __name__ == '__main__':

    translate = []
    preprocess =[]
    union_final = ""
    route = ""
    if (len(sys.argv) == 2):
        route = sys.argv[1]
    else:
        print "ERROR:::: Need one argument to create the features file" 
        sys.exit(-1)
    try:
	    translate = readFile(route+"/translateFile", translate) ## translateFile
    except:
	    print "No file in translate"
	    translate = ["?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?"]
    try:
	    preprocess = readFile(route+"/features.arff", preprocess) ## features.arff
    except:
	    print "No file in preprocess"
	    preprocess = ["?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?\n"]
    try:
	    union_final = join(translate, preprocess, union_final)
    except:
	    print "General error"
	    union_final = "?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?"
    head = Head([])
    writeFile(route+"/global_features.arff", union_final, head)

